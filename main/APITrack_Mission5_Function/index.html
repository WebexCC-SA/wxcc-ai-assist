<!DOCTYPE html><html lang="en" class="no-js"><head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Webex Contact Center AI Assistant">
      
      
        <meta name="author" content="iulluwis">
      
      
      
      
      
      <link rel="icon" href="../../template_assets/cisco_logo.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.22">
    
    
      
        <title>Mission 5: Personalized Customer Notification with Functions - Webex Contact Center AI Assistant</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.84d31ad4.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&amp;display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  <link href="../../assets/stylesheets/glightbox.min.css" rel="stylesheet"><script src="../../assets/javascripts/glightbox.min.js"></script><style id="glightbox-style">
            html.glightbox-open { overflow: initial; height: 100%; }
            .gslide-title { margin-top: 0px; user-select: text; }
            .gslide-desc { color: #666; user-select: text; }
            .gslide-image img { background: white; }
            .gscrollbar-fixer { padding-right: 15px; }
            .gdesc-inner { font-size: 0.75rem; }
            body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color); }
            body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color); }
            body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color); }
        </style></head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="custom" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#mission-5-personalized-customer-notification-with-functions" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Webex Contact Center AI Assistant" class="md-header__button md-logo" aria-label="Webex Contact Center AI Assistant" data-md-component="logo">
      
  <img src="../../template_assets/cisco_logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"></path></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Webex Contact Center AI Assistant
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Mission 5: Personalized Customer Notification with Functions
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="custom" data-md-color-accent="indigo" aria-label="Switch to dark mode" type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"></path></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="custom" data-md-color-accent="indigo" aria-label="Switch to light mode" type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"></path></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../overview/" class="md-tabs__link">
          
  
  
    
  
  Getting Started

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../AI_Lab_Features_Overview/" class="md-tabs__link">
          
  
  
    
  
  AI Assistant

        </a>
      </li>
    
  

    
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Webex Contact Center AI Assistant" class="md-nav__button md-logo" aria-label="Webex Contact Center AI Assistant" data-md-component="logo">
      
  <img src="../../template_assets/cisco_logo.png" alt="logo">

    </a>
    Webex Contact Center AI Assistant
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1">
        
          
          <label class="md-nav__link" for="__nav_1" id="__nav_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Getting Started
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            Getting Started
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../overview/" class="md-nav__link">
        
  
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2A10 10 0 0 0 2 12a10 10 0 0 0 10 10 10 10 0 0 0 10-10c0-1.16-.21-2.31-.61-3.39l-1.6 1.6c.14.59.21 1.19.21 1.79a8 8 0 0 1-8 8 8 8 0 0 1-8-8 8 8 0 0 1 8-8c.6 0 1.2.07 1.79.21L15.4 2.6C14.31 2.21 13.16 2 12 2m7 0-4 4v1.5l-2.55 2.55C12.3 10 12.15 10 12 10a2 2 0 0 0-2 2 2 2 0 0 0 2 2 2 2 0 0 0 2-2c0-.15 0-.3-.05-.45L16.5 9H18l4-4h-3zm-7 4a6 6 0 0 0-6 6 6 6 0 0 0 6 6 6 6 0 0 0 6-6h-2a4 4 0 0 1-4 4 4 4 0 0 1-4-4 4 4 0 0 1 4-4z"></path></svg>
  
  <span class="md-ellipsis">
    Lab Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../PreRequisites/" class="md-nav__link">
        
  
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2A10 10 0 0 0 2 12a10 10 0 0 0 10 10 10 10 0 0 0 10-10c0-1.16-.21-2.31-.61-3.39l-1.6 1.6c.14.59.21 1.19.21 1.79a8 8 0 0 1-8 8 8 8 0 0 1-8-8 8 8 0 0 1 8-8c.6 0 1.2.07 1.79.21L15.4 2.6C14.31 2.21 13.16 2 12 2m7 0-4 4v1.5l-2.55 2.55C12.3 10 12.15 10 12 10a2 2 0 0 0-2 2 2 2 0 0 0 2 2 2 2 0 0 0 2-2c0-.15 0-.3-.05-.45L16.5 9H18l4-4h-3zm-7 4a6 6 0 0 0-6 6 6 6 0 0 0 6 6 6 6 0 0 0 6-6h-2a4 4 0 0 1-4 4 4 4 0 0 1-4-4 4 4 0 0 1 4-4z"></path></svg>
  
  <span class="md-ellipsis">
    Access you Lab Environment
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../quicklinks/" class="md-nav__link">
        
  
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M6.1 10 4 18V8h17a2 2 0 0 0-2-2h-7l-2-2H4a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h15c.9 0 1.7-.6 1.9-1.5l2.3-8.5zM19 18H6l1.6-6h13z"></path></svg>
  
  <span class="md-ellipsis">
    Quick Links
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2">
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    AI Assistant
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            AI Assistant
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1">
        
          
          <label class="md-nav__link" for="__nav_2_1" id="__nav_2_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Lab Guide
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1">
            <span class="md-nav__icon md-icon"></span>
            Lab Guide
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../AI_Lab_Features_Overview/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Lab overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../AI_Lab_Assist_Mission1/" class="md-nav__link">
        
  
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 2H4v2l5.81 4.36a7.004 7.004 0 0 0-4.46 8.84 6.996 6.996 0 0 0 8.84 4.46 7 7 0 0 0 0-13.3L20 4zm-5.06 17.5L12 17.78 9.06 19.5l.78-3.33-2.59-2.24 3.41-.29L12 10.5l1.34 3.14 3.41.29-2.59 2.24z"></path></svg>
  
  <span class="md-ellipsis">
    Mission 1: AI Agent Transfer Summary
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../AI_Lab_Assist_Mission_2/" class="md-nav__link">
        
  
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 2H4v2l5.81 4.36a7.004 7.004 0 0 0-4.46 8.84 6.996 6.996 0 0 0 8.84 4.46 7 7 0 0 0 0-13.3L20 4zm-5.06 17.5L12 17.78 9.06 19.5l.78-3.33-2.59-2.24 3.41-.29L12 10.5l1.34 3.14 3.41.29-2.59 2.24z"></path></svg>
  
  <span class="md-ellipsis">
    Mission 2: Call Drop Summary
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../AI_Lab_Assist_Mission3/" class="md-nav__link">
        
  
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 2H4v2l5.81 4.36a7.004 7.004 0 0 0-4.46 8.84 6.996 6.996 0 0 0 8.84 4.46 7 7 0 0 0 0-13.3L20 4zm-5.06 17.5L12 17.78 9.06 19.5l.78-3.33-2.59-2.24 3.41-.29L12 10.5l1.34 3.14 3.41.29-2.59 2.24z"></path></svg>
  
  <span class="md-ellipsis">
    Mission 3: Real Time Transcript
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../AI_Lab_Assist_AutoCSAT/" class="md-nav__link">
        
  
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 2H4v2l5.81 4.36a7.004 7.004 0 0 0-4.46 8.84 6.996 6.996 0 0 0 8.84 4.46 7 7 0 0 0 0-13.3L20 4zm-5.06 17.5L12 17.78 9.06 19.5l.78-3.33-2.59-2.24 3.41-.29L12 10.5l1.34 3.14 3.41.29-2.59 2.24z"></path></svg>
  
  <span class="md-ellipsis">
    Mission 4: AutoCSAT
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../AI_Lab_Assist_Conclusion/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Conclusion
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="mission-5-personalized-customer-notification-with-functions">Mission 5: Personalized Customer Notification with Functions</h1>
<h2 id="story">Story</h2>
<p>In this mission, you will use a <strong>Function Node</strong> in WxCC to retrieve customer data from an external database and generate a personalized message using JavaScript. This ensures callers receive real-time updates on their last purchase, outstanding balance, and service requests without agent intervention.</p>
<h2 id="call-flow-overview">Call Flow Overview</h2>
<ol>
<li>When call arrives fetch the data from <strong>MockAPI</strong> based on your Dialed Number.<br></li>
<li>Write the data into respective preconfigured flow variables. These variables will be passed to a Function.<br></li>
<li>Function will generate a message based on inputs and pass it back to your flow.<br></li>
<li>Play Message node plays the message received from Function.<br></li>
</ol>
<h2 id="mission-details">Mission Details</h2>
<p>Your mission is to:</p>
<ol>
<li>Create a function that retrieves input variables, processes them, and generates a customer-friendly message.<br></li>
<li>Create a new flow with the Function element.<br></li>
<li>Request data from an external database, parse it into flow variables, and pass them to your Function.<br></li>
<li>Play the message generated by the Function to the caller.<br></li>
</ol>
<blockquote>
<p><strong></strong></p><details><summary><strong>Good to Know <span style="color: orange;">[Optional]</span></strong></summary><p></p>
<p>We are going to imitate a real API server by providing realistic responses to requests. For that we chose Server <a href="https://mockapi.io/" target="_blank"><strong>MockAPI</strong></a>.</p>
<p>For more information of how you can use MockAPI please watch these Vidcasts: 
<a href="https://app.vidcast.io/share/ce058b71-109e-4929-b9ca-46b83d94f7e3" target="_blank"><strong>[ADVANCED] Use MockAPI to enhance your Demos - PART 1</strong></a> and <a href="https://app.vidcast.io/share/1e259a34-7e9e-44d9-aa5a-5d76e07256a3" target="_blank"><strong>[ADVANCED] Use MockAPI to enhance your Demos - PART 2</strong></a></p>
</details>
</blockquote>
<h2 id="building-function">Building Function</h2>
<ol>
<li>
<p>Switch to Control Hub, then navigate to <strong>Functions</strong>, click on <strong>Create a function</strong> then select <strong>Create a function</strong> from drop down list. </p>
</li>
<li>
<p>New Tab will be opened. Select <strong>Start Fresh</strong> and provide name <strong><span class="attendee-id-container">Function_<span class="attendee-id-placeholder" data-prefix="Function_">Your_Attendee_ID</span><span class="copy" title="Click to copy!"></span></span></strong> then click <strong>Create Function</strong>.</p>
<p><a class="glightbox" data-type="image" data-width="100%" data-height="auto" href="../../graphics/APIFunction/API_Function1.gif" data-title="Profiles" data-desc-position="top"><img alt="Profiles" src="../../graphics/APIFunction/API_Function1.gif"></a></p>
</li>
<li>
<p>Switch <strong>Read-Only</strong> mode from <strong>Off</strong> to <strong>On</strong> and add following variables by clicking <strong>Add Input Variables</strong>:</p>
<ul>
<li>Last purchase date variable:</li>
</ul>
<blockquote>
<p>Name: <strong>lastPurchase</strong><span class="copy-static" data-copy-text="lastPurchase"><span class="copy" title="Click to copy!"></span></span></p>
<p>Type: <strong>String</strong></p>
<p>Default Value: <em>empty</em></p>
<p>Variable Value: <em>put space character</em></p>
</blockquote>
<ul>
<li>Customer pending request variable:</li>
</ul>
<blockquote>
<p>Name: <strong>pendingServiceRequest</strong><span class="copy-static" data-copy-text="pendingServiceRequest"><span class="copy" title="Click to copy!"></span></span></p>
<p>Type: <strong>String</strong></p>
<p>Default Value: <em>empty</em></p>
<p>Variable Value: <em>put space character</em></p>
</blockquote>
<ul>
<li>Expected resolution date variable:</li>
</ul>
<blockquote>
<p>Name: <strong>resolutionDate</strong><span class="copy-static" data-copy-text="resolutionDate"><span class="copy" title="Click to copy!"></span></span></p>
<p>Type: <strong>String</strong></p>
<p>Default Value: <em>empty</em></p>
<p>Variable Value: <em>put space character</em></p>
</blockquote>
<ul>
<li>Outstanding account balance variable:</li>
</ul>
<blockquote>
<p>Name: <strong>outstandingBalance</strong><span class="copy-static" data-copy-text="outstandingBalance"><span class="copy" title="Click to copy!"></span></span></p>
<p>Type: <strong>String</strong></p>
<p>Default Value: <em>empty</em></p>
<p>Variable Value: <em>put space character</em></p>
</blockquote>
</li>
<li>
<p>Add output variable <strong>personalizedMessage</strong><span class="copy-static" data-copy-text="personalizedMessage"><span class="copy" title="Click to copy!"></span></span> in <strong>Output Variable Definition</strong> field.</p>
<p><a class="glightbox" data-type="image" data-width="100%" data-height="auto" href="../../graphics/APIFunction/API_Function2.gif" data-title="Profiles" data-desc-position="top"><img alt="Profiles" src="../../graphics/APIFunction/API_Function2.gif"></a></p>
</li>
<li>
<p>Clear the editor from the default code and paste the following JavaScript code into Function editor.</p>
<div class="language-JSON highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="w"> </span><span class="err">expor</span><span class="kc">t</span><span class="w"> </span><span class="err">co</span><span class="kc">nst</span><span class="w"> </span><span class="err">ha</span><span class="kc">n</span><span class="err">dle</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="err">asy</span><span class="kc">n</span><span class="err">c</span><span class="w"> </span><span class="err">(reques</span><span class="kc">t</span><span class="p">,</span><span class="w"> </span><span class="err">respo</span><span class="kc">nse</span><span class="err">)</span><span class="w"> </span><span class="err">=&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="w">    </span><span class="c1">// Retrieve input variables (all as strings)</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="w">    </span><span class="err">var</span><span class="w"> </span><span class="err">las</span><span class="kc">t</span><span class="err">Purchase</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="err">reques</span><span class="kc">t</span><span class="err">.i</span><span class="kc">n</span><span class="err">pu</span><span class="kc">ts</span><span class="err">.las</span><span class="kc">t</span><span class="err">Purchase;</span><span class="w">  </span><span class="c1">// e.g., '17-03-2025'</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="w">    </span><span class="err">var</span><span class="w"> </span><span class="err">ou</span><span class="kc">tstan</span><span class="err">di</span><span class="kc">n</span><span class="err">gBala</span><span class="kc">n</span><span class="err">ce</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="err">reques</span><span class="kc">t</span><span class="err">.i</span><span class="kc">n</span><span class="err">pu</span><span class="kc">ts</span><span class="err">.ou</span><span class="kc">tstan</span><span class="err">di</span><span class="kc">n</span><span class="err">gBala</span><span class="kc">n</span><span class="err">ce;</span><span class="w">  </span><span class="c1">// e.g., '120.50'</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="w">    </span><span class="err">var</span><span class="w"> </span><span class="err">pe</span><span class="kc">n</span><span class="err">di</span><span class="kc">n</span><span class="err">gServiceReques</span><span class="kc">t</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="err">reques</span><span class="kc">t</span><span class="err">.i</span><span class="kc">n</span><span class="err">pu</span><span class="kc">ts</span><span class="err">.pe</span><span class="kc">n</span><span class="err">di</span><span class="kc">n</span><span class="err">gServiceReques</span><span class="kc">t</span><span class="err">;</span><span class="w">  </span><span class="c1">// e.g., 'Network issue'</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="w">    </span><span class="err">var</span><span class="w"> </span><span class="err">resolu</span><span class="kc">t</span><span class="err">io</span><span class="kc">n</span><span class="err">Da</span><span class="kc">te</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="err">reques</span><span class="kc">t</span><span class="err">.i</span><span class="kc">n</span><span class="err">pu</span><span class="kc">ts</span><span class="err">.resolu</span><span class="kc">t</span><span class="err">io</span><span class="kc">n</span><span class="err">Da</span><span class="kc">te</span><span class="err">;</span><span class="w">  </span><span class="c1">// e.g., '20-03-2025'</span>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="w">    </span><span class="c1">// Convert outstandingBalance to a number safely</span>
</span><span id="__span-0-9"><a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="w">    </span><span class="err">le</span><span class="kc">t</span><span class="w"> </span><span class="err">bala</span><span class="kc">n</span><span class="err">ceAmou</span><span class="kc">nt</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="err">parseFloa</span><span class="kc">t</span><span class="err">(ou</span><span class="kc">tstan</span><span class="err">di</span><span class="kc">n</span><span class="err">gBala</span><span class="kc">n</span><span class="err">ce);</span>
</span><span id="__span-0-10"><a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="w">    </span><span class="err">i</span><span class="kc">f</span><span class="w"> </span><span class="err">(isNaN(bala</span><span class="kc">n</span><span class="err">ceAmou</span><span class="kc">nt</span><span class="err">))</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-0-11"><a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="w">        </span><span class="err">bala</span><span class="kc">n</span><span class="err">ceAmou</span><span class="kc">nt</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="mi">0</span><span class="err">;</span><span class="w">  </span><span class="c1">// Default to 0 if conversion fails</span>
</span><span id="__span-0-12"><a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-0-13"><a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a>
</span><span id="__span-0-14"><a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a><span class="w">    </span><span class="c1">// Function to convert 'DD-MM-YYYY' to a proper Date object</span>
</span><span id="__span-0-15"><a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a><span class="w">    </span><span class="kc">fun</span><span class="err">c</span><span class="kc">t</span><span class="err">io</span><span class="kc">n</span><span class="w"> </span><span class="err">parseDa</span><span class="kc">te</span><span class="err">(da</span><span class="kc">te</span><span class="err">S</span><span class="kc">tr</span><span class="err">i</span><span class="kc">n</span><span class="err">g)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-0-16"><a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a><span class="w">        </span><span class="err">i</span><span class="kc">f</span><span class="w"> </span><span class="err">(!da</span><span class="kc">te</span><span class="err">S</span><span class="kc">tr</span><span class="err">i</span><span class="kc">n</span><span class="err">g)</span><span class="w"> </span><span class="err">re</span><span class="kc">turn</span><span class="w"> </span><span class="kc">null</span><span class="err">;</span>
</span><span id="__span-0-17"><a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a><span class="w">        </span><span class="err">co</span><span class="kc">nst</span><span class="w"> </span><span class="err">par</span><span class="kc">ts</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="err">da</span><span class="kc">te</span><span class="err">S</span><span class="kc">tr</span><span class="err">i</span><span class="kc">n</span><span class="err">g.spli</span><span class="kc">t</span><span class="err">('</span><span class="mi">-</span><span class="err">');</span><span class="w"> </span><span class="c1">// Split "17-03-2025" into ["17", "03", "2025"]</span>
</span><span id="__span-0-18"><a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a><span class="w">        </span><span class="err">i</span><span class="kc">f</span><span class="w"> </span><span class="err">(par</span><span class="kc">ts</span><span class="err">.le</span><span class="kc">n</span><span class="err">g</span><span class="kc">t</span><span class="err">h</span><span class="w"> </span><span class="err">!==</span><span class="w"> </span><span class="mi">3</span><span class="err">)</span><span class="w"> </span><span class="err">re</span><span class="kc">turn</span><span class="w"> </span><span class="kc">null</span><span class="err">;</span><span class="w"> </span><span class="c1">// Invalid format</span>
</span><span id="__span-0-19"><a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a>
</span><span id="__span-0-20"><a id="__codelineno-0-20" name="__codelineno-0-20" href="#__codelineno-0-20"></a><span class="w">        </span><span class="err">co</span><span class="kc">nst</span><span class="w"> </span><span class="p">[</span><span class="err">day</span><span class="p">,</span><span class="w"> </span><span class="err">mo</span><span class="kc">nt</span><span class="err">h</span><span class="p">,</span><span class="w"> </span><span class="err">year</span><span class="p">]</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="err">par</span><span class="kc">ts</span><span class="err">.map(</span><span class="kc">nu</span><span class="err">m</span><span class="w"> </span><span class="err">=&gt;</span><span class="w"> </span><span class="err">parseI</span><span class="kc">nt</span><span class="err">(</span><span class="kc">nu</span><span class="err">m</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="err">));</span>
</span><span id="__span-0-21"><a id="__codelineno-0-21" name="__codelineno-0-21" href="#__codelineno-0-21"></a><span class="w">        </span><span class="err">re</span><span class="kc">turn</span><span class="w"> </span><span class="kc">ne</span><span class="err">w</span><span class="w"> </span><span class="err">Da</span><span class="kc">te</span><span class="err">(year</span><span class="p">,</span><span class="w"> </span><span class="err">mo</span><span class="kc">nt</span><span class="err">h</span><span class="w"> </span><span class="mi">-</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="err">day);</span><span class="w"> </span><span class="c1">// Month is 0-based in JS Dates</span>
</span><span id="__span-0-22"><a id="__codelineno-0-22" name="__codelineno-0-22" href="#__codelineno-0-22"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-0-23"><a id="__codelineno-0-23" name="__codelineno-0-23" href="#__codelineno-0-23"></a>
</span><span id="__span-0-24"><a id="__codelineno-0-24" name="__codelineno-0-24" href="#__codelineno-0-24"></a><span class="w">    </span><span class="c1">// Format the date to a readable string (e.g., "March 17, 2025")</span>
</span><span id="__span-0-25"><a id="__codelineno-0-25" name="__codelineno-0-25" href="#__codelineno-0-25"></a><span class="w">    </span><span class="kc">fun</span><span class="err">c</span><span class="kc">t</span><span class="err">io</span><span class="kc">n</span><span class="w"> </span><span class="kc">f</span><span class="err">orma</span><span class="kc">t</span><span class="err">Da</span><span class="kc">te</span><span class="err">(da</span><span class="kc">te</span><span class="err">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-0-26"><a id="__codelineno-0-26" name="__codelineno-0-26" href="#__codelineno-0-26"></a><span class="w">        </span><span class="err">re</span><span class="kc">turn</span><span class="w"> </span><span class="err">da</span><span class="kc">te</span><span class="w"> </span><span class="err">?</span><span class="w"> </span><span class="err">da</span><span class="kc">te</span><span class="err">.</span><span class="kc">t</span><span class="err">oLocaleDa</span><span class="kc">te</span><span class="err">S</span><span class="kc">tr</span><span class="err">i</span><span class="kc">n</span><span class="err">g('e</span><span class="kc">n</span><span class="mi">-</span><span class="err">US'</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="err">year</span><span class="p">:</span><span class="w"> </span><span class="err">'</span><span class="kc">nu</span><span class="err">meric'</span><span class="p">,</span><span class="w"> </span><span class="err">mo</span><span class="kc">nt</span><span class="err">h</span><span class="p">:</span><span class="w"> </span><span class="err">'lo</span><span class="kc">n</span><span class="err">g'</span><span class="p">,</span><span class="w"> </span><span class="err">day</span><span class="p">:</span><span class="w"> </span><span class="err">'</span><span class="kc">nu</span><span class="err">meric'</span><span class="w"> </span><span class="p">}</span><span class="err">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="err">;</span>
</span><span id="__span-0-27"><a id="__codelineno-0-27" name="__codelineno-0-27" href="#__codelineno-0-27"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-0-28"><a id="__codelineno-0-28" name="__codelineno-0-28" href="#__codelineno-0-28"></a>
</span><span id="__span-0-29"><a id="__codelineno-0-29" name="__codelineno-0-29" href="#__codelineno-0-29"></a><span class="w">    </span><span class="c1">// Parse and format dates</span>
</span><span id="__span-0-30"><a id="__codelineno-0-30" name="__codelineno-0-30" href="#__codelineno-0-30"></a><span class="w">    </span><span class="err">le</span><span class="kc">t</span><span class="w"> </span><span class="kc">f</span><span class="err">orma</span><span class="kc">tte</span><span class="err">dLas</span><span class="kc">t</span><span class="err">Purchase</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="kc">f</span><span class="err">orma</span><span class="kc">t</span><span class="err">Da</span><span class="kc">te</span><span class="err">(parseDa</span><span class="kc">te</span><span class="err">(las</span><span class="kc">t</span><span class="err">Purchase));</span>
</span><span id="__span-0-31"><a id="__codelineno-0-31" name="__codelineno-0-31" href="#__codelineno-0-31"></a><span class="w">    </span><span class="err">le</span><span class="kc">t</span><span class="w"> </span><span class="kc">f</span><span class="err">orma</span><span class="kc">tte</span><span class="err">dResolu</span><span class="kc">t</span><span class="err">io</span><span class="kc">n</span><span class="err">Da</span><span class="kc">te</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="kc">f</span><span class="err">orma</span><span class="kc">t</span><span class="err">Da</span><span class="kc">te</span><span class="err">(parseDa</span><span class="kc">te</span><span class="err">(resolu</span><span class="kc">t</span><span class="err">io</span><span class="kc">n</span><span class="err">Da</span><span class="kc">te</span><span class="err">));</span>
</span><span id="__span-0-32"><a id="__codelineno-0-32" name="__codelineno-0-32" href="#__codelineno-0-32"></a>
</span><span id="__span-0-33"><a id="__codelineno-0-33" name="__codelineno-0-33" href="#__codelineno-0-33"></a><span class="w">    </span><span class="c1">// Generate the personalized message</span>
</span><span id="__span-0-34"><a id="__codelineno-0-34" name="__codelineno-0-34" href="#__codelineno-0-34"></a><span class="w">    </span><span class="err">le</span><span class="kc">t</span><span class="w"> </span><span class="err">message</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="err">'Hello</span><span class="p">,</span><span class="w"> </span><span class="err">we</span><span class="w"> </span><span class="err">have</span><span class="w"> </span><span class="err">some</span><span class="w"> </span><span class="err">i</span><span class="kc">nf</span><span class="err">orma</span><span class="kc">t</span><span class="err">io</span><span class="kc">n</span><span class="w"> </span><span class="err">abou</span><span class="kc">t</span><span class="w"> </span><span class="err">your</span><span class="w"> </span><span class="err">accou</span><span class="kc">nt</span><span class="p">:</span><span class="err">';</span>
</span><span id="__span-0-35"><a id="__codelineno-0-35" name="__codelineno-0-35" href="#__codelineno-0-35"></a>
</span><span id="__span-0-36"><a id="__codelineno-0-36" name="__codelineno-0-36" href="#__codelineno-0-36"></a><span class="w">    </span><span class="err">i</span><span class="kc">f</span><span class="w"> </span><span class="err">(</span><span class="kc">f</span><span class="err">orma</span><span class="kc">tte</span><span class="err">dLas</span><span class="kc">t</span><span class="err">Purchase)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-0-37"><a id="__codelineno-0-37" name="__codelineno-0-37" href="#__codelineno-0-37"></a><span class="w">        </span><span class="err">message</span><span class="w"> </span><span class="err">+=</span><span class="w"> </span><span class="err">`</span><span class="w"> </span><span class="err">Your</span><span class="w"> </span><span class="err">las</span><span class="kc">t</span><span class="w"> </span><span class="err">purchase</span><span class="w"> </span><span class="err">was</span><span class="w"> </span><span class="err">o</span><span class="kc">n</span><span class="w"> </span><span class="err">$</span><span class="p">{</span><span class="kc">f</span><span class="err">orma</span><span class="kc">tte</span><span class="err">dLas</span><span class="kc">t</span><span class="err">Purchase</span><span class="p">}</span><span class="err">.`;</span>
</span><span id="__span-0-38"><a id="__codelineno-0-38" name="__codelineno-0-38" href="#__codelineno-0-38"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-0-39"><a id="__codelineno-0-39" name="__codelineno-0-39" href="#__codelineno-0-39"></a><span class="w">    </span><span class="err">i</span><span class="kc">f</span><span class="w"> </span><span class="err">(bala</span><span class="kc">n</span><span class="err">ceAmou</span><span class="kc">nt</span><span class="w"> </span><span class="err">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="err">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-0-40"><a id="__codelineno-0-40" name="__codelineno-0-40" href="#__codelineno-0-40"></a><span class="w">        </span><span class="err">message</span><span class="w"> </span><span class="err">+=</span><span class="w"> </span><span class="err">`</span><span class="w"> </span><span class="err">You</span><span class="w"> </span><span class="err">have</span><span class="w"> </span><span class="err">a</span><span class="kc">n</span><span class="w"> </span><span class="err">ou</span><span class="kc">tstan</span><span class="err">di</span><span class="kc">n</span><span class="err">g</span><span class="w"> </span><span class="err">bala</span><span class="kc">n</span><span class="err">ce</span><span class="w"> </span><span class="err">o</span><span class="kc">f</span><span class="w"> </span><span class="err">$$</span><span class="p">{</span><span class="err">bala</span><span class="kc">n</span><span class="err">ceAmou</span><span class="kc">nt</span><span class="err">.</span><span class="kc">t</span><span class="err">oFixed(</span><span class="mi">2</span><span class="err">)</span><span class="p">}</span><span class="err">.`;</span>
</span><span id="__span-0-41"><a id="__codelineno-0-41" name="__codelineno-0-41" href="#__codelineno-0-41"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-0-42"><a id="__codelineno-0-42" name="__codelineno-0-42" href="#__codelineno-0-42"></a><span class="w">    </span><span class="err">i</span><span class="kc">f</span><span class="w"> </span><span class="err">(pe</span><span class="kc">n</span><span class="err">di</span><span class="kc">n</span><span class="err">gServiceReques</span><span class="kc">t</span><span class="err">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-0-43"><a id="__codelineno-0-43" name="__codelineno-0-43" href="#__codelineno-0-43"></a><span class="w">        </span><span class="err">message</span><span class="w"> </span><span class="err">+=</span><span class="w"> </span><span class="err">`</span><span class="w"> </span><span class="err">We</span><span class="w"> </span><span class="err">also</span><span class="w"> </span><span class="err">have</span><span class="w"> </span><span class="err">a</span><span class="w"> </span><span class="err">pe</span><span class="kc">n</span><span class="err">di</span><span class="kc">n</span><span class="err">g</span><span class="w"> </span><span class="err">service</span><span class="w"> </span><span class="err">reques</span><span class="kc">t</span><span class="p">:</span><span class="w"> </span><span class="err">$</span><span class="p">{</span><span class="err">pe</span><span class="kc">n</span><span class="err">di</span><span class="kc">n</span><span class="err">gServiceReques</span><span class="kc">t</span><span class="p">}</span><span class="err">`;</span>
</span><span id="__span-0-44"><a id="__codelineno-0-44" name="__codelineno-0-44" href="#__codelineno-0-44"></a><span class="w">        </span><span class="err">i</span><span class="kc">f</span><span class="w"> </span><span class="err">(</span><span class="kc">f</span><span class="err">orma</span><span class="kc">tte</span><span class="err">dResolu</span><span class="kc">t</span><span class="err">io</span><span class="kc">n</span><span class="err">Da</span><span class="kc">te</span><span class="err">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-0-45"><a id="__codelineno-0-45" name="__codelineno-0-45" href="#__codelineno-0-45"></a><span class="w">            </span><span class="err">message</span><span class="w"> </span><span class="err">+=</span><span class="w"> </span><span class="err">`</span><span class="p">,</span><span class="w"> </span><span class="err">resolu</span><span class="kc">t</span><span class="err">io</span><span class="kc">n</span><span class="w"> </span><span class="err">by</span><span class="w"> </span><span class="err">$</span><span class="p">{</span><span class="kc">f</span><span class="err">orma</span><span class="kc">tte</span><span class="err">dResolu</span><span class="kc">t</span><span class="err">io</span><span class="kc">n</span><span class="err">Da</span><span class="kc">te</span><span class="p">}</span><span class="err">.`;</span>
</span><span id="__span-0-46"><a id="__codelineno-0-46" name="__codelineno-0-46" href="#__codelineno-0-46"></a><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="err">else</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-0-47"><a id="__codelineno-0-47" name="__codelineno-0-47" href="#__codelineno-0-47"></a><span class="w">            </span><span class="err">message</span><span class="w"> </span><span class="err">+=</span><span class="w"> </span><span class="err">`.`;</span>
</span><span id="__span-0-48"><a id="__codelineno-0-48" name="__codelineno-0-48" href="#__codelineno-0-48"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-0-49"><a id="__codelineno-0-49" name="__codelineno-0-49" href="#__codelineno-0-49"></a><span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="err">else</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-0-50"><a id="__codelineno-0-50" name="__codelineno-0-50" href="#__codelineno-0-50"></a><span class="w">        </span><span class="err">message</span><span class="w"> </span><span class="err">+=</span><span class="w"> </span><span class="err">'</span><span class="w"> </span><span class="err">There</span><span class="w"> </span><span class="err">are</span><span class="w"> </span><span class="kc">n</span><span class="err">o</span><span class="w"> </span><span class="err">pe</span><span class="kc">n</span><span class="err">di</span><span class="kc">n</span><span class="err">g</span><span class="w"> </span><span class="err">service</span><span class="w"> </span><span class="err">reques</span><span class="kc">ts</span><span class="w"> </span><span class="err">a</span><span class="kc">t</span><span class="w"> </span><span class="kc">t</span><span class="err">he</span><span class="w"> </span><span class="err">mome</span><span class="kc">nt</span><span class="err">.';</span>
</span><span id="__span-0-51"><a id="__codelineno-0-51" name="__codelineno-0-51" href="#__codelineno-0-51"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-0-52"><a id="__codelineno-0-52" name="__codelineno-0-52" href="#__codelineno-0-52"></a>
</span><span id="__span-0-53"><a id="__codelineno-0-53" name="__codelineno-0-53" href="#__codelineno-0-53"></a><span class="w">    </span><span class="c1">// Return the generated message</span>
</span><span id="__span-0-54"><a id="__codelineno-0-54" name="__codelineno-0-54" href="#__codelineno-0-54"></a><span class="w">    </span><span class="err">respo</span><span class="kc">nse</span><span class="err">.da</span><span class="kc">ta</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="err">'perso</span><span class="kc">nal</span><span class="err">izedMessage'</span><span class="p">:</span><span class="w"> </span><span class="err">message</span><span class="w"> </span><span class="p">}</span><span class="err">;</span>
</span><span id="__span-0-55"><a id="__codelineno-0-55" name="__codelineno-0-55" href="#__codelineno-0-55"></a>
</span><span id="__span-0-56"><a id="__codelineno-0-56" name="__codelineno-0-56" href="#__codelineno-0-56"></a><span class="w">    </span><span class="err">re</span><span class="kc">turn</span><span class="w"> </span><span class="err">respo</span><span class="kc">nse</span><span class="err">;</span>
</span><span id="__span-0-57"><a id="__codelineno-0-57" name="__codelineno-0-57" href="#__codelineno-0-57"></a><span class="w">    </span><span class="p">}</span><span class="err">;</span>
</span></code></pre></div>
<p><a class="glightbox" data-type="image" data-width="100%" data-height="auto" href="../../graphics/APIFunction/API_Function3.gif" data-title="Profiles" data-desc-position="top"><img alt="Profiles" src="../../graphics/APIFunction/API_Function3.gif"></a></p>
<blockquote>
<p><strong></strong></p><details><summary><strong>Good to know: Script Breakdown<span style="color: orange;">[Optional]</span></strong></summary><p></p>
<p>This script dynamically generates a personalized message for customers based on their account details. In our lab it is a Channel Support Number assigned to you. It is used within Webex Contact Center (WxCC) Flow Designer to enhance customer interactions.</p>
<ol>
<li>
<p>How It Works:<br>
   Retrieves input variables from the Flow:<br></p>
<ul>
<li><code>lastPurchase</code> → Date of the last purchase (e.g., <code>"17-03-2025"</code>).<br></li>
<li><code>outstandingBalance</code> → The amount owed by the customer (e.g., <code>"120.50"</code>).<br></li>
<li><code>pendingServiceRequest</code> → Details of any unresolved service request (e.g., <code>"Network issue"</code>).<br></li>
<li><code>resolutionDate</code> → Expected resolution date of the service request (e.g., <code>"20-03-2025"</code>).<br></li>
</ul>
</li>
<li>
<p>Processes and formats the data:<br></p>
<ul>
<li>Converts <code>lastPurchase</code> and <code>resolutionDate</code> from <code>"DD-MM-YYYY"</code> format into a more readable format (<code>March 17, 2025</code>).<br></li>
<li>Ensures <code>outstandingBalance</code> is a valid number and avoids errors if it’s missing or invalid.<br></li>
</ul>
</li>
<li>Generates a customer-friendly message:<br><ul>
<li>If the customer made a purchase, the date is included.<br></li>
<li>If an outstanding balance exists, the amount is shown.<br></li>
<li>If there’s a pending service request, it’s mentioned, along with a resolution date (if available).<br></li>
<li>If no pending issues exist, it confirms that everything is fine.<br></li>
</ul>
</li>
<li>Returns the message to be used in the Flow:<br><ul>
<li>The script outputs <code>personalizedMessage</code>, which can be read out in an IVR or displayed to an agent.<br>
</li></ul></li></ol></details>
<br></blockquote></li>


</ol>


<li>
<p>Perform a test to see how you script preforms by clicking on <strong>Test</strong> pannel below the editor. Provide following data into respective fields. Then click <strong>Test</strong> button.</p>
<blockquote>
<p><code>lastPurchase</code>: <strong>17-03-2025</strong><span class="copy-static" data-copy-text="17-03-2025"><span class="copy" title="Click to copy!"></span></span></p>
<p><code>pendingServiceRequest</code>: <strong>Network issue on Amsterdam location</strong><span class="copy-static" data-copy-text="Network issue on Amsterdam location"><span class="copy" title="Click to copy!"></span></span></p>
<p><code>resolutionDate</code>: <strong>20-03-2025</strong><span class="copy-static" data-copy-text="20-03-2025"><span class="copy" title="Click to copy!"></span></span></p>
<p><code>outstandingBalance</code>: <strong>529.51</strong><span class="copy-static" data-copy-text="529.51"><span class="copy" title="Click to copy!"></span></span>
</p>
</blockquote>
</li>
<li>
<p>Click on <strong>Publish Function</strong> and again click <strong>Publish Function</strong> in pop up window.</p>
<p><a class="glightbox" data-type="image" data-width="100%" data-height="auto" href="../../graphics/APIFunction/API_Function4.gif" data-title="Profiles" data-desc-position="top"><img alt="Profiles" src="../../graphics/APIFunction/API_Function4.gif"></a></p>
</li>

<hr>
<h2 id="building-flow">Building Flow</h2>
<ol>
<li>
<p>Switch to Control Hub, then navigate to <strong>Flows</strong>, click on <strong>Manage Flows</strong> then select <strong>Create Flows</strong> from drop down list. </p>
</li>
<li>
<p>Select <strong>Start Fresh</strong> then enter flow name <strong><span class="attendee-id-container">FunctionFlow_<span class="attendee-id-placeholder" data-prefix="FunctionFlow_">Your_Attendee_ID</span><span class="copy" title="Click to copy!"></span></span></strong>. Click on <strong>Create Flow</strong>.</p>
<p><a class="glightbox" data-type="image" data-width="100%" data-height="auto" href="../../graphics/APIFunction/API_Function5.gif" data-title="Profiles" data-desc-position="top"><img alt="Profiles" src="../../graphics/APIFunction/API_Function5.gif"></a></p>
</li>
<li>
<p>Add these flow variables:</p>
<ul>
<li>Last purchase date variable:</li>
</ul>
<blockquote>
<p>Name: <strong>lastPurchase</strong><span class="copy-static" data-copy-text="lastPurchase"><span class="copy" title="Click to copy!"></span></span></p>
<p>Type: <strong>String</strong></p>
<p>Default Value: <em>empty</em></p>
</blockquote>
<ul>
<li>Customer pending request variable:</li>
</ul>
<blockquote>
<p>Name: <strong>pendingServiceRequest</strong><span class="copy-static" data-copy-text="pendingServiceRequest"><span class="copy" title="Click to copy!"></span></span></p>
<p>Type: <strong>String</strong></p>
<p>Default Value: <em>empty</em></p>
</blockquote>
<ul>
<li>Expected resolution date variable:</li>
</ul>
<blockquote>
<p>Name: <strong>resolutionDate</strong><span class="copy-static" data-copy-text="resolutionDate"><span class="copy" title="Click to copy!"></span></span></p>
<p>Type: <strong>String</strong></p>
<p>Default Value: <em>empty</em></p>
</blockquote>
<ul>
<li>Outstanding account balance variable:</li>
</ul>
<blockquote>
<p>Name: <strong>outstandingBalance</strong><span class="copy-static" data-copy-text="outstandingBalance"><span class="copy" title="Click to copy!"></span></span></p>
<p>Type: <strong>String</strong></p>
<p>Default Value: <em>empty</em></p>
</blockquote>
<ul>
<li>HTTP Response variable:</li>
</ul>
<blockquote>
<p>Name: <strong>HTTPResponse</strong><span class="copy-static" data-copy-text="HTTPResponse"><span class="copy" title="Click to copy!"></span></span></p>
<p>Type: <strong>String</strong></p>
<p>Default Value: <em>empty</em></p>
</blockquote>
<ul>
<li>Personalized message variable:</li>
</ul>
<blockquote>
<p>Name: <strong>personalizedMessage</strong><span class="copy-static" data-copy-text="personalizedMessage"><span class="copy" title="Click to copy!"></span></span></p>
<p>Type: <strong>String</strong></p>
<p>Default Value: <em>empty</em></p>
</blockquote>
<p><a class="glightbox" data-type="image" data-width="100%" data-height="auto" href="../../graphics/APIFunction/API_Function6.gif" data-title="Profiles" data-desc-position="top"><img alt="Profiles" src="../../graphics/APIFunction/API_Function6.gif"></a></p>
<blockquote>
<p><strong></strong></p><details><summary>Test your API Source<strong><span style="color: orange;">[Optional]</span></strong></summary><p></p>
<ol>
<li>
<p>Test your API resource. <strong>https://674481b1b4e2e04abea27c6e.mockapi.io/flowdesigner/Lab/DynVars?dn={DNIS}</strong><span class="copy-static" data-copy-text="https://674481b1b4e2e04abea27c6e.mockapi.io/flowdesigner/Lab/DynVars?dn={DNIS}"><span class="copy" title="Click to copy!"></span></span></p>
</li>
<li>
<p>Replace DNIS with the provided DNIS number stripping +1</p>
</li>
</ol>
<p><span style="color: orange;">[Example:]</span> If your number <strong>+14694096861</strong>, then your GET Query should be <strong><em>https://674481b1b4e2e04abea27c6e.mockapi.io/flowdesigner/Lab/DynVars?dn=4694096861</em></strong></p>
<ol>
<li>Open Chrome browser and past your URL. You should get the follwoing result</li>
</ol>
<p><a class="glightbox" data-type="image" data-width="100%" data-height="auto" href="../../graphics/Lab2/BM2-8-Chrometest.gif" data-title="Profiles" data-desc-position="top"><img alt="Profiles" src="../../graphics/Lab2/BM2-8-Chrometest.gif"></a></p>
<ol>
<li>
<p>Test JSON Path in the following tool <a href="https://jsonpath.com/" target="_blank">https://jsonpath.com/</a></p>
</li>
<li>
<p>Paste your GET URL into the Browser address line and copy the output in square brackets (including brackets)</p>
</li>
<li>
<p>Open <a href="https://jsonpath.com/" target="_blank">https://jsonpath.com/</a> and paste the copied response into <strong>Inputs</strong> window</p>
</li>
<li>
<p>In <strong>JSONPath</strong> box copy and paste one of the path expression from <strong>FetchFlowSettings</strong> to verify your results.</p>
</li>
</ol>
<p><a class="glightbox" data-type="image" data-width="100%" data-height="auto" href="../../graphics/Lab2/BM2-10-JSONPath.gif" data-title="Profiles" data-desc-position="top"><img alt="Profiles" src="../../graphics/Lab2/BM2-10-JSONPath.gif"></a>
</p></details><p></p>
</blockquote>
</li>
<li>
<p>Add an <strong>HTTP Request</strong> node. We are going to fetch data and write it into our new created variables <code>lastPurchase</code>, <code>pendingServiceRequest</code>, <code>resolutionDate</code> and <code>outstandingBalance</code>.</p>
<blockquote>
<p>Connect <strong>NewPhoneContact</strong> to this HTTP node</p>
<p>We will connct <strong>HTTP Request</strong> node in next step</p>
<p>Activity Name: <strong>GET_HTTPRequest</strong><span class="copy-static" data-copy-text="GET_HTTPRequest"><span class="copy" title="Click to copy!"></span></span></p>
<p>Use Authenticated Endpoint: <strong>Off</strong></p>
<p>Requestt URL: <strong><em>https://674481b1b4e2e04abea27c6e.mockapi.io/flowdesigner/Lab/DynVars?dn={{NewPhoneContact.DNIS | slice(2) }}</em></strong><span class="copy-static" data-copy-text="https://674481b1b4e2e04abea27c6e.mockapi.io/flowdesigner/Lab/DynVars?dn={{NewPhoneContact.DNIS | slice(2) }}"><span class="copy" title="Click to copy!"></span></span></p>
<p>Method: <strong>GET</strong></p>
<p>Content Type: <strong>Application/JSON</strong></p>
<p><strong>Parsing Settings:</strong></p>
<p>Content Type: <strong>JSON</strong> </p>
<blockquote>
<p>Output Variable: <strong><code>pendingServiceRequest</code></strong><span class="copy-static" data-copy-text="pendingServiceRequest"><span class="copy" title="Click to copy!"></span></span></p>
<p>Path Expression: <strong><code>$[0].pendingServiceRequest</code></strong><span class="copy-static" data-copy-text="$[0].pendingServiceRequest"><span class="copy" title="Click to copy!"></span></span></p>
</blockquote>
<p>Click <strong>Add New</strong></p>
<blockquote>
<p>Output Variable: <strong><code>lastPurchase</code></strong><span class="copy-static" data-copy-text="lastPurchase"><span class="copy" title="Click to copy!"></span></span></p>
<p>Path Expression: <strong><code>$[0].lastPurchase</code></strong><span class="copy-static" data-copy-text="$[0].lastPurchase"><span class="copy" title="Click to copy!"></span></span></p>
</blockquote>
<p>Click <strong>Add New</strong></p>
<blockquote>
<p>Output Variable: <strong><code>outstandingBalance</code></strong><span class="copy-static" data-copy-text="outstandingBalance"><span class="copy" title="Click to copy!"></span></span></p>
<p>Path Expression: <strong><code>$[0].outstandingBalance</code></strong><span class="copy-static" data-copy-text="$[0].outstandingBalance"><span class="copy" title="Click to copy!"></span></span></p>
</blockquote>
<p>Click <strong>Add New</strong></p>
<blockquote>
<p>Output Variable: <strong><code>resolutionDate</code></strong><span class="copy-static" data-copy-text="resolutionDate"><span class="copy" title="Click to copy!"></span></span></p>
<p>Path Expression: <strong><code>$[0].resolutionDate</code></strong><span class="copy-static" data-copy-text="$[0].resolutionDate"><span class="copy" title="Click to copy!"></span></span></p>
</blockquote>
</blockquote>
<p><a class="glightbox" data-type="image" data-width="100%" data-height="auto" href="../../graphics/APIFunction/API_Function7.gif" data-title="Profiles" data-desc-position="top"><img alt="Profiles" src="../../graphics/APIFunction/API_Function7.gif"></a></p>
</li>
<li>
<p>Add <strong>Set Variable</strong> node</p>
<blockquote>
<p>Activity Label: <strong>HTTP_Response</strong><span class="copy-static" data-copy-text="HTTP_Response"><span class="copy" title="Click to copy!"></span></span></p>
<p>Connect <strong>GET_HTTPRequest</strong> to this node</p>
<p>We will connct <strong>Set Variable</strong> node in next step</p>
<p>Variable: <strong><code>HTTPResponse</code></strong><span class="copy-static" data-copy-text="HTTPResponse"><span class="copy" title="Click to copy!"></span></span></p>
<p>Set To Variable: <strong><code>GET_HTTPRequest.httpResponseBody</code></strong><span class="copy-static" data-copy-text="GET_HTTPRequest.httpResponseBody"><span class="copy" title="Click to copy!"></span></span>
</p>
</blockquote>
<p><a class="glightbox" data-type="image" data-width="100%" data-height="auto" href="../../graphics/APIFunction/API_Function8.gif" data-title="Profiles" data-desc-position="top"><img alt="Profiles" src="../../graphics/APIFunction/API_Function8.gif"></a></p>
</li>
<li>
<p>Switch to <strong>Functions</strong> tab in the left menu. Then drag <strong><span class="attendee-id-container">Function_<span class="attendee-id-placeholder" data-prefix="Function_">Your_Attendee_ID</span><span class="copy" title="Click to copy!"></span></span></strong> node to the canvas.</p>
<blockquote>
<p>Connect <strong>HTTP_Response</strong> to this node</p>
<p>We will connect this node in next step</p>
<p>Function Version Label: <strong>Latest</strong></p>
<p><strong>Function Input Variables</strong> should auto populate</p>
<p><strong>Output Settings</strong></p>
<blockquote>
<p>Output Variable: <strong><code>personalizedMessage</code></strong><span class="copy-static" data-copy-text="personalizedMessage"><span class="copy" title="Click to copy!"></span></span></p>
<p>Path Expression <strong><code>$.personalizedMessage</code></strong><span class="copy-static" data-copy-text="personalizedMessage"><span class="copy" title="Click to copy!"></span></span></p>
</blockquote>
</blockquote>
<p><a class="glightbox" data-type="image" data-width="100%" data-height="auto" href="../../graphics/APIFunction/API_Function9.gif" data-title="Profiles" data-desc-position="top"><img alt="Profiles" src="../../graphics/APIFunction/API_Function9.gif"></a></p>
</li>
<li>
<p>Switch to <strong>Activity</strong> tab in the left menu. Add <strong>Play Message</strong> and <strong>Disconnect Contact</strong> nodes </p>
<blockquote>
<p>Connect the <strong>Function</strong> node edge to this <strong>Play Message</strong> node</p>
<p>Enable Text-To-Speech</p>
<p>Select the Connector: <strong>Cisco Cloud Text-to-Speech</strong></p>
<p>Click the Add Text-to-Speech Message button</p>
<p>Delete the Selection for Audio File</p>
<p>Text-to-Speech Message: <strong>{{personalizedMessage}}</strong><span class="copy-static" data-copy-text="{{personalizedMessage}}"><span class="copy" title="Click to copy!"></span></span></p>
<p>Connect the <strong>Play Message</strong> node edge to this <strong>Disconnect Contact</strong> node
<br></p>
</blockquote>
</li>
<li>
<p>Publish your flow</p>
<blockquote>
<p>Turn on Validation at the bottom right corner of the flow builder</p>
<p>If there are no Flow Errors, Click <strong>Publish</strong></p>
<p>Add a publish note</p>
<p>Add Version Label(s): <strong>Latest</strong> </p>
<p>Click <strong>Publish</strong> Flow</p>
</blockquote>
<p><a class="glightbox" data-type="image" data-width="100%" data-height="auto" href="../../graphics/APIFunction/API_Function10.gif" data-title="Profiles" data-desc-position="top"><img alt="Profiles" src="../../graphics/APIFunction/API_Function10.gif"></a>
<br></p>
</li>
<li>
<p>Map your flow to your inbound channel</p>
<blockquote>
<p>Navigate to Control Hub &gt; Contact Center &gt; Channels</p>
<p>Locate your Inbound Channel (you can use the search): <strong><span class="attendee-id-container"><span class="attendee-id-placeholder" data-suffix="_Channel">Your_Attendee_ID</span>_Channel<span class="copy" title="Click to copy!"></span></span></strong></p>
<p>Select the Routing Flow: <strong><span class="attendee-id-container">FunctionFlow_<span class="attendee-id-placeholder" data-prefix="FunctionFlow_">Your_Attendee_ID</span><span class="copy" title="Click to copy!"></span></span></strong></p>
<p>Select the Version Label: <strong>Latest</strong></p>
<p>Click <strong>Save</strong> in the lower right corner of the screen</p>
</blockquote>
<p><a class="glightbox" data-type="image" data-width="100%" data-height="auto" href="../../graphics/APIFunction/API_Function11.gif" data-title="Profiles" data-desc-position="top"><img alt="Profiles" src="../../graphics/APIFunction/API_Function11.gif"></a></p>
</li>
</ol>
<h2 id="testing">Testing</h2>
<ol>
<li>
<p>Open your Webex App and dial the Support Number provided to you, which is configured in your <strong><span class="attendee-id-placeholder">Your_Attendee_ID</span>_Channel</strong> configuration.</p>
<p><a class="glightbox" data-type="image" data-width="100%" data-height="auto" href="../../graphics/Lab1/WxApp_Test.gif" data-title="profiles" data-desc-position="top"><img alt="profiles" src="../../graphics/Lab1/WxApp_Test.gif"></a></p>
</li>
<li>
<p>Verify if you hear a message built inside your function.</p>
</li>
<li>
<p>Switch to Flow Designer and click Debug tab at the bottom and select last interaction (first in the list)</p>
</li>
<li>
<p>Click on <strong>GET_HTTPRequest</strong> and on the right hand side window scoll to the bottom. Check if <strong>Modified Variables</strong> have values assigned.</p>
</li>
<li>
<p>Click on <strong>HTTP_Response</strong> to see full HTTP response body in <strong>Modified Variables</strong>.</p>
</li>
<li>
<p>Click on <strong>Function</strong> step and check if Modified Variables contains <code>**personalizedMessage**</code> built by your function.</p>
<p><a class="glightbox" data-type="image" data-width="100%" data-height="auto" href="../../graphics/APIFunction/API_Function12.gif" data-title="Profiles" data-desc-position="top"><img alt="Profiles" src="../../graphics/APIFunction/API_Function12.gif"></a></p>
</li>
</ol>
<p style="text-align:center"><strong>Congratulations, you have succesfully completed Function mission! 🎉🎉 </strong></p>







  
  






                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"></path></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright © 2025 Cisco Systems Inc. All Rights Reserved.
    </div>
  
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.tabs", "navigation.tabs.sticky", "navigation.indexes", "navigation.instant", "navigation.top", "navigation.footer", "search.suggest", "content.code.copy", "toc.integrate", "content.tooltips", "content.footnote.tooltips", "codehilite"], "search": "../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.f55a23d4.min.js"></script>
      
        <script src="../../js/copy-button.js"></script>
      
        <script src="../../js/attendee-id.js"></script>
      
    
  
<script id="init-glightbox">const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": false, "openEffect": "fade", "closeEffect": "fade", "slideEffect": "slide"});
document$.subscribe(()=>{ lightbox.reload(); });
</script></body></html>